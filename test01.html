<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kathryn 11+ VR Expert Mode</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

<style>
:root {
--primary:#6c5ce7; --core:#55efc4; --elite:#fd79a8;
--bg:#0f172a; --card-bg:#1e293b; --text:#f8fafc;
}
body { font-family:Arial; background:var(--bg); color:var(--text); padding:20px;}
.container{max-width:900px;margin:auto;}
.btn{padding:10px 18px;border-radius:8px;border:none;cursor:pointer;font-weight:bold;}
.btn-gen{background:var(--primary);color:white;}
.btn-record{background:#e74c3c;color:white;}
.btn-play-rec{background:#f1c40f;color:black;}
.vocab-card{background:var(--card-bg);padding:25px;border-radius:15px;margin-bottom:20px;}
</style>
</head>

<body>

<div class="container">
  <h1>ðŸš€ Kathryn 11+ VR ç·´ç¿’ç³»çµ±</h1>
  Week:
  <input id="weekInput" type="number" value="1" style="width:60px">

  <div id="mainDisplay"></div>
</div>

<script>
const GAS_URL =
'https://script.google.com/macros/s/AKfycbxPeeeBTqiT2-MFsH4R_aHTPOdGZTeNicNJWMA4qG1jGasJHjpi_as_cUGoeS_Y3Ck8sg/exec';

let currentWords = [
  { word:'EXCITED', type:'CORE' },
  { word:'BRAVE', type:'CORE' }
];

function render(){
  const d=document.getElementById('mainDisplay');
  d.innerHTML='';
  currentWords.forEach((item,i)=>{
    d.innerHTML+=`
      <div class="vocab-card">
        <h2>${item.word}</h2>
        <div id="challenge-${i}"></div>
        <button class="btn btn-gen" onclick="startChallenge(${i})">
          Start Challenge
        </button>
      </div>`;
  });
}

function startChallenge(i){
  const item=currentWords[i];
  const word=item.word.toUpperCase();
  const letters=word.split('').sort(()=>Math.random()-0.5);

  let answer=Array(word.length).fill('');
  const div=document.getElementById(`challenge-${i}`);
  div.innerHTML='';

  const box=document.createElement('div');
  box.style.fontSize='2em';
  box.style.marginBottom='10px';
  update();

  function update(){ box.textContent=answer.join(' '); }

  letters.forEach(l=>{
    const b=document.createElement('button');
    b.textContent=l;
    b.className='btn btn-gen';
    b.onclick=()=>{
      const idx=answer.indexOf('');
      if(idx>-1){ answer[idx]=l; update(); }
    };
    div.appendChild(b);
  });

  const back=document.createElement('button');
  back.textContent='âŒ«';
  back.className='btn btn-record';
  back.onclick=()=>{
    for(let i=answer.length-1;i>=0;i--){
      if(answer[i]){ answer[i]=''; update(); break; }
    }
  };

  const submit=document.createElement('button');
  submit.textContent='Submit';
  submit.className='btn btn-play-rec';
  submit.onclick=()=>{
    fetch(GAS_URL,{
      method:'POST',
      mode:'no-cors',
      body:JSON.stringify({
        week:document.getElementById('weekInput').value,
        correctWord:word,
        kathrynAnswer:answer.join('')
      }),
      headers:{'Content-Type':'application/json'}
    });
    alert('âœ… Answer saved!');
  };

  div.prepend(box);
  div.append(back,submit);
}

render();
</script>

</body>
</html>
